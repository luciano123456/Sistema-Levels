@* =========================================================
   Botón flotante tipo FAB (Home dinámico según menú)
========================================================= *@

<link href="~/css/BotonMenu.css" rel="stylesheet" />

<div class="fab-wrap" data-fab>
    <!-- Botón principal (Home dinámico) -->
    <a class="fab-main"
       href="javascript:void(0)"
       title="Inicio"
       data-bs-toggle="tooltip"
       data-bs-placement="right"
       onclick="redirigirSegunMenu()">
        <i class="fa fa-home"></i>
        <span class="fab-label d-none d-md-inline">Inicio</span>
    </a>
</div>

<script>
    /* =========================================================
       CONFIGURACIÓN
    ========================================================= */
    const LS_MENU_TYPE = 'menu_tipo'; // 'clasico' | 'personalizado'

    /* =========================================================
       NAVEGACIÓN HOME SEGÚN MENÚ
    ========================================================= */
    function irHomeSegunMenu() {
        const menu = localStorage.getItem(LS_MENU_TYPE);

        // Si no existe configuración aún, default clásico
        if (!menu || menu === 'clasico') {
            window.location.href = '/Home';
            return;
        }

        if (menu === 'personalizado') {
            window.location.href = '/HomePersonalizado';
            return;
        }

        // Fallback de seguridad
        window.location.href = '/Home';
    }

    /* =========================================================
       TOOLTIPS BOOTSTRAP 5 (MISMO QUE TENÍAS)
    ========================================================= */
    document.querySelectorAll('[data-bs-toggle="tooltip"]').forEach(el => {
        try { new bootstrap.Tooltip(el); } catch (_) {}
    });

    /* =========================================================
       FAB MOBILE BEHAVIOR (MISMO CÓDIGO ORIGINAL)
    ========================================================= */
    (function () {
        const fab = document.querySelector('[data-fab]');
        if (!fab) return;

        const main = fab.querySelector('.fab-main');

        main.addEventListener('click', function (e) {
            // Si tiene dock con items, toggle; si está vacío navega normal
            const hasItems = fab.querySelectorAll('.fab-dock .fab-item').length > 0;
            if (window.matchMedia('(hover: none)').matches && hasItems) {
                e.preventDefault();
                fab.classList.toggle('open');
            }
        });

        // Cerrar al clickear afuera
        document.addEventListener('click', function (e) {
            if (!fab.contains(e.target)) fab.classList.remove('open');
        });
    })();
</script>
